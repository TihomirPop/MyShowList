import"../chunks/DsnmJJEf.js";import{d as Be,a as Ne,s as M,b as ce,o as Oe,f as d,e as r,g as l,i as n,j as e,k as S,m as o,n as je,q as Fe,$ as He,v as t,w as ee,x as ue,y as w,z as de,A as F,B as Pe,C as Qe}from"../chunks/DT7DyGpg.js";import{i as L,a as ae,g as Re}from"../chunks/DCGF0svJ.js";import{b as Ue,e as ze,f as Ge,g as We,s as Ye}from"../chunks/DVctERAW.js";import{h as $e,r as qe,s as H}from"../chunks/B_ysz1NM.js";import{b as Je}from"../chunks/CCDdTn80.js";var Ke=d('<span class="show-count svelte-1uha8ag"> </span>'),Xe=d('<div class="loading-container"><div class="loading-spinner"></div> <p>Loading shows...</p></div>'),Ze=d('<div class="error-banner"> </div> <div style="text-align: center; margin-top: 1rem;"><button class="btn-primary">Try Again</button></div>',1),ea=d('<p class="svelte-1uha8ag"> </p> <p class="hint svelte-1uha8ag">Try a different search term.</p>',1),aa=d('<p class="svelte-1uha8ag">No shows available yet.</p> <p class="hint svelte-1uha8ag">Check back later for new content!</p>',1),ta=d('<div class="empty-state svelte-1uha8ag"><!></div>'),ra=d('<img class="thumbnail-image svelte-1uha8ag"/>'),sa=d('<div class="thumbnail-placeholder svelte-1uha8ag"></div>'),la=d('<div class="show-genres svelte-1uha8ag"> </div>'),oa=d('<a class="show-card-link svelte-1uha8ag"><article class="show-card svelte-1uha8ag"><div class="show-thumbnail svelte-1uha8ag"><!> <span class="show-type-badge svelte-1uha8ag"> </span></div> <div class="show-info svelte-1uha8ag"><h3 class="svelte-1uha8ag"> </h3> <div class="show-score svelte-1uha8ag"><span class="score-icon svelte-1uha8ag">⭐</span> <span class="score-value svelte-1uha8ag"> </span></div> <!></div></article></a>'),ia=d('<div class="shows-grid svelte-1uha8ag"></div>'),va=d('<div class="container svelte-1uha8ag"><div class="hero svelte-1uha8ag"><h1 class="svelte-1uha8ag"> </h1> <p class="hero-text svelte-1uha8ag">Welcome to MyShowList - Your personal TV show tracker</p></div> <section class="shows-section svelte-1uha8ag"><h2 class="svelte-1uha8ag">All Shows <!></h2> <div class="controls-section svelte-1uha8ag"><div class="control-group search-group svelte-1uha8ag"><label for="search-input" class="svelte-1uha8ag">Search:</label> <input type="search" id="search-input" placeholder="Search shows..." aria-label="Search shows" class="svelte-1uha8ag"/></div> <div class="control-group svelte-1uha8ag"><label for="sort-field" class="svelte-1uha8ag">Sort by:</label> <select id="sort-field" aria-label="Sort shows by" class="svelte-1uha8ag"><option>Average Score</option><option>Release Date</option></select></div> <button type="button" class="sort-direction-btn svelte-1uha8ag" aria-label="Toggle sort direction"> </button></div> <!></section></div>');function pa(he,ge){Ne(ge,!0);let te=M(ce([])),y=M(!0),x=M(null),P=M(ce(new Map)),Q=M("averageScore"),I=M("desc"),E=M("");function pe(a){const s=new Map(e(P));s.set(a,!0),n(P,s,!0)}function fe(a,s){if(!s.trim())return a;const m=s.toLowerCase();return a.filter(g=>!!(g.title.toLowerCase().includes(m)||g.description.toLowerCase().includes(m)||g.genres.some(p=>p.toLowerCase().includes(m))))}function _e(a,s,m){const g=[...a];return g.sort((p,i)=>{let f;if(s==="averageScore"){if(p.averageScore===null&&i.averageScore===null)return 0;if(p.averageScore===null)return 1;if(i.averageScore===null)return-1;f=p.averageScore-i.averageScore}else{const b=p.type==="MOVIE"?p.releaseDate:p.startDate,k=i.type==="MOVIE"?i.releaseDate:i.startDate;if(b===null&&k===null)return 0;if(b===null)return 1;if(k===null)return-1;const T=new Date(b).getTime(),_=new Date(k).getTime();f=T-_}return m==="asc"?f:-f}),g}const me=ue(()=>fe(e(te),e(E))),N=ue(()=>_e(e(me),e(Q),e(I)));Oe(async()=>{await re()});async function re(){if(!ae.token){n(x,"Not authenticated"),n(y,!1);return}n(y,!0),n(x,null);try{const a=await Re(ae.token);"shows"in a?n(te,a.shows,!0):n(x,a.message||"Failed to load shows",!0)}catch(a){a instanceof Error?n(x,a.message,!0):n(x,"An unexpected error occurred")}finally{n(y,!1)}}var R=va();$e("1uha8ag",a=>{Fe(()=>{He.title="Home - MyShowList"})});var U=r(R),se=r(U),be=r(se);t(se),ee(2),t(U);var le=l(U,2),z=r(le),we=l(r(z));{var Se=a=>{var s=Ke(),m=r(s);t(s),S(g=>w(m,`(${e(N).length??""}${g??""})`),[()=>e(E).trim()?" filtered":""]),o(a,s)};L(we,a=>{e(N).length>0&&a(Se)})}t(z);var G=l(z,2),W=r(G),Y=l(r(W),2);qe(Y),t(W);var $=l(W,2),O=l(r($),2),q=r(O);q.value=q.__value="averageScore";var oe=l(q);oe.value=oe.__value="date",t(O),t($);var V=l($,2);V.__click=()=>n(I,e(I)==="asc"?"desc":"asc",!0);var ye=r(V,!0);t(V),t(G);var xe=l(G,2);{var ke=a=>{var s=Xe();o(a,s)},Ae=a=>{var s=de(),m=F(s);{var g=i=>{var f=Ze(),b=F(f),k=r(b,!0);t(b);var T=l(b,2),_=r(T);_.__click=re,t(T),S(()=>w(k,e(x))),o(i,f)},p=i=>{var f=de(),b=F(f);{var k=_=>{var A=ta(),B=r(A);{var v=h=>{var D=ea(),C=F(D),j=r(C);t(C),ee(2),S(()=>w(j,`No shows found matching "${e(E)??""}"`)),o(h,D)},J=h=>{var D=aa();ee(2),o(h,D)};L(B,h=>{e(E).trim()?h(v):h(J,!1)})}t(A),o(_,A)},T=_=>{var A=ia();ze(A,23,()=>e(N),B=>B.id,(B,v,J)=>{var h=oa(),D=r(h),C=r(D),j=r(C);{var De=c=>{var u=ra();S(()=>{H(u,"src",e(v).thumbnailUrl),H(u,"alt",`${e(v).title??""} poster`)}),Pe("error",u,()=>pe(e(v).id)),Qe(u),o(c,u)},Me=c=>{var u=sa();S(Z=>Ye(u,`background: ${Z??""};`),[()=>We(e(J))]),o(c,u)};L(j,c=>{!e(P).get(e(v).id)&&e(v).thumbnailUrl?c(De):c(Me,!1)})}var ie=l(j,2),Le=r(ie,!0);t(ie),t(C);var ve=l(C,2),K=r(ve),Ee=r(K,!0);t(K);var X=l(K,2),ne=l(r(X),2),Te=r(ne,!0);t(ne),t(X);var Ce=l(X,2);{var Ie=c=>{var u=la(),Z=r(u,!0);t(u),S(Ve=>w(Z,Ve),[()=>e(v).genres.slice(0,3).join(" • ")]),o(c,u)};L(Ce,c=>{e(v).genres.length>0&&c(Ie)})}t(ve),t(D),t(h),S(c=>{H(h,"href",`/shows/${e(v).id??""}`),w(Le,e(v).type==="MOVIE"?"Movie":"TV"),w(Ee,e(v).title),w(Te,c)},[()=>Ge(e(v).averageScore)]),o(B,h)}),t(A),o(_,A)};L(b,_=>{e(N).length===0?_(k):_(T,!1)},!0)}o(i,f)};L(m,i=>{e(x)?i(g):i(p,!1)},!0)}o(a,s)};L(xe,a=>{e(y)?a(ke):a(Ae,!1)})}t(le),t(R),S(()=>{w(be,`Hello, ${ae.user?.username??""}!`),Y.disabled=e(y),O.disabled=e(y),V.disabled=e(y),H(V,"title",e(I)==="asc"?"Ascending":"Descending"),w(ye,e(I)==="asc"?"⭡":"⭣")}),Je(Y,()=>e(E),a=>n(E,a)),Ue(O,()=>e(Q),a=>n(Q,a)),o(he,R),je()}Be(["click"]);export{pa as component};
