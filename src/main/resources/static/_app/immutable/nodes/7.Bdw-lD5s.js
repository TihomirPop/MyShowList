import{e as o}from"../chunks/C3zk5da-.js";import{a as l,c as x,u as F}from"../chunks/DJ-Tgj2u.js";import{i as G,a as I,b as O}from"../chunks/CtVqx6bY.js";import"../chunks/DsnmJJEf.js";import{a as U,s as w,b as A,f as E,k as N,m as R,n as j,a2 as M,g as y,e as f,$ as C,v as g,w as T,j as p,y as L,W as S,i as r}from"../chunks/DDMLW2bY.js";import{h as P,s as V}from"../chunks/Dq8RMBer.js";import{S as q}from"../chunks/C-8qlI8s.js";const z=async({params:e})=>{const{id:s}=e;if(!l.token)throw o(401,"Not authenticated");if(l.user?.role!=="ADMIN")throw o(403,"Only administrators can edit shows");const n=await x(s,l.token);if(G(n))throw o(404,"Show not found");if(I(n))throw o(500,n.message||"Failed to load show");if(!O(n))throw o(500,"Failed to load show");return{show:n.show}},te=Object.freeze(Object.defineProperty({__proto__:null,load:z},Symbol.toStringTag,{value:"Module"}));function B(e){return!("message"in e)&&!("missingGenres"in e)&&Object.keys(e).length===0}function H(e){return!("message"in e)&&!("missingGenres"in e)&&Object.keys(e).length===0}function W(e){return"missingGenres"in e}function J(e){return"message"in e&&!("missingGenres"in e)}var K=E('<div class="container svelte-1y5uyfi"><nav class="breadcrumb svelte-1y5uyfi"><a href="/" class="svelte-1y5uyfi">Home</a> <span class="separator svelte-1y5uyfi">/</span> <a class="svelte-1y5uyfi"> </a> <span class="separator svelte-1y5uyfi">/</span> <span class="current svelte-1y5uyfi">Edit</span></nav> <!></div>');function se(e,s){U(s,!0);let n=w(!1),a=w(A({}));async function m(t){if(r(a,{},!0),!l.token){r(a,{general:"Not authenticated"},!0);return}r(n,!0);try{const u=t.showType==="MOVIE"?{id:s.data.show.id,type:"MOVIE",title:t.title.trim(),description:t.description.trim(),thumbnailUrl:t.thumbnailUrl.trim(),genres:Array.from(t.selectedGenres),releaseDate:t.releaseDate}:{id:s.data.show.id,type:"TV_SERIES",title:t.title.trim(),description:t.description.trim(),thumbnailUrl:t.thumbnailUrl.trim(),genres:Array.from(t.selectedGenres),episodeCount:Number(t.episodeCount),startDate:t.startDate,endDate:t.endDate},i=await F(s.data.show.id,u,l.token);if(B(i)){S(`/shows/${s.data.show.id}`);return}if(H(i)){r(a,{general:"Show not found. It may have been deleted."},!0);return}if(W(i)){r(a,{genres:`The following genres do not exist: ${i.missingGenres.join(", ")}`},!0);return}if(J(i)){r(a,{general:i.message},!0);return}r(a,{general:"An unexpected error occurred"},!0)}catch(u){r(a,{general:u instanceof Error?u.message:"An unexpected error occurred"},!0)}finally{r(n,!1)}}function v(){S(`/shows/${s.data.show.id}`)}var d=K();P("1y5uyfi",t=>{M(()=>{C.title=`Edit ${s.data.show.title??""} - MyShowList`})});var c=f(d),h=y(f(c),4),b=f(h,!0);g(h),T(4),g(c);var _=y(c,2);q(_,{mode:"edit",get initialData(){return s.data.show},get isLoading(){return p(n)},get errors(){return p(a)},onSubmit:m,onCancel:v}),g(d),N(()=>{V(h,"href",`/shows/${s.data.show.id??""}`),L(b,s.data.show.title)}),R(e,d),j()}export{se as component,te as universal};
